<!DOCTYPE html>
<html lang="en">]
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AttentEase - Master Your Focus, Amplify Your Productivity</title>
  <meta name="description" content="Transform scattered attention into laser-sharp focus with AttentEase. AI-powered productivity platform designed for modern professionals.">
  <!-- Fonts: Norwester, Poppins, Inter, JetBrains Mono -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/norwester" rel="stylesheet">
  <style>
    /* Design System */
    :root {
      --bg: #0a0b10;
      --muted: #9ca3af;
      --accent-1: #7c3aed;
      --accent-2: #06b6d4;
      --accent-3: #f59e0b;
      --white: #ffffff;
      --glass: rgba(255,255,255,0.08);
      --radius: 20px;
      --fast: 180ms;
      --heading-font: 'Norwester', 'Poppins', system-ui, sans-serif;
      --mono-font: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, monospace;
      --body-font: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      font-family: var(--body-font);
      color: var(--white);
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,0.25), transparent 50%),
        radial-gradient(1000px 500px at 90% 10%, rgba(6,182,212,0.25), transparent 60%),
        linear-gradient(135deg, #0a0b10 0%, #0b0d16 40%, #0a0b10 100%);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }

    /* Global */
    h1,h2,h3 { font-family: var(--heading-font); text-transform: uppercase; letter-spacing: .5px; text-shadow: 0 2px 20px rgba(124,58,237,.25); }
    section { padding: 100px 6%; position: relative; margin-bottom: 60px; opacity: 0; transform: translateY(60px); transition: opacity .7s ease, transform .7s ease; }
    .section-visible { opacity: 1; transform: translateY(0); }

    /* Background blob */
    .bg-blob {
      position: fixed; inset: -20% -10% auto auto; width: 60vw; height: 60vw;
      background:
        radial-gradient(closest-side, rgba(124,58,237,.45), transparent),
        radial-gradient(closest-side, rgba(6,182,212,.35), transparent 60%);
      filter: blur(60px);
      mix-blend-mode: overlay;
      pointer-events: none; z-index: 0;
      border-radius: 50%;
      animation: blobShift 18s ease-in-out infinite alternate;
    }
    @keyframes blobShift { from { transform: translate(-6%, -4%) rotate(0deg); } to { transform: translate(6%, 2%) rotate(20deg); } }

    /* Navbar */
    .navbar { position: fixed; top: 0; width: 100%; z-index: 1000; }
    .nav-content {
      margin: 14px auto; height: 72px; max-width: 1200px; padding: 0 20px;
      display: flex; align-items: center; justify-content: space-between;
      background: linear-gradient(135deg, rgba(255,255,255,0.07), rgba(255,255,255,0.03));
      backdrop-filter: blur(14px);
      border: 1px solid rgba(255,255,255,0.12);
      box-shadow: 0 10px 40px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,0.05);
      border-radius: 16px; transition: transform .25s ease, box-shadow .25s ease;
    }
    .navbar.shrink .nav-content { transform: scale(0.98) translateY(-6px); box-shadow: 0 8px 30px rgba(0,0,0,.6); }
    .logo { display: flex; align-items: center; gap: 10px; }
    .logo-icon { width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, var(--accent-1), var(--accent-2)); display:flex; align-items:center; justify-content:center; font-weight: 800; font-size: 14px; box-shadow: 0 10px 30px rgba(124,58,237,.45); }
    .logo-text { font-weight: 800; font-size: 20px; letter-spacing: .5px; }
    .nav-links { display: flex; gap: 12px; list-style: none; }
    .nav-links a { position: relative; display:inline-block; padding: 10px 14px; border-radius: 999px; color: var(--white); text-decoration: none; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); transition: transform var(--fast) ease, box-shadow var(--fast) ease; }
    .nav-links a:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(124,58,237,.35); }
    .nav-links a::after { content: ""; position: absolute; left: 16px; right: 16px; bottom: 6px; height: 2px; border-radius: 2px; background: linear-gradient(90deg, var(--accent-2), var(--accent-1)); opacity: 0; transform: translateY(4px); transition: .25s; }
    .nav-links a:hover::after { opacity: 1; transform: translateY(0); }
    .nav-buttons { display: flex; gap: 10px; align-items: center; }

    /* Buttons */
    .btn { position: relative; display:inline-block; padding: 12px 18px; border-radius: 14px; border: 1px solid rgba(255,255,255,0.10); cursor: pointer; font-weight: 600; transition: transform var(--fast) ease, box-shadow var(--fast) ease, background var(--fast) ease; text-decoration: none; }
    .btn-primary { background: linear-gradient(135deg, var(--accent-2), var(--accent-1)); color: #fff; box-shadow: 0 10px 30px rgba(6,182,212,.3); overflow: hidden; }
    .btn-primary::before { content:""; position:absolute; inset:-1px; background: linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent); transform: translateX(-120%); animation: btnShimmer 3.2s linear infinite; }
    @keyframes btnShimmer { 0% { transform: translateX(-120%);} 100% { transform: translateX(120%);} }
    .btn-primary:hover { transform: translateY(-2px) scale(1.01); box-shadow: 0 14px 40px rgba(124,58,237,.45); }
    .btn-secondary { background: rgba(255,255,255,0.05); color: #fff; border: 1px solid rgba(6,182,212,.6); }
    .btn-secondary:hover { transform: translateY(-2px); box-shadow: inset 0 0 0 1px rgba(6,182,212,.8), 0 10px 26px rgba(6,182,212,.35); }
    .btn-lg { padding: 16px 26px; font-size: 18px; border-radius: 16px; }

    /* Hero */
    .hero { min-height: 100vh; display:grid; grid-template-columns: 1.2fr 1fr; align-items:center; gap: 40px; padding-top: 120px; }
    .hero-text { text-align: left; }
    .hero-text h1 { font-size: clamp(3rem, 7vw, 5.5rem); background: linear-gradient(135deg, var(--accent-1), var(--accent-2), var(--accent-1)); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color: transparent; margin-bottom: 14px; }
    .hero-subtitle { font-size: clamp(1.1rem, 2.5vw, 1.6rem); color: var(--muted); margin-bottom: 12px; }
    .hero-description { font-size: 1.05rem; color: #cbd5e1; margin-bottom: 26px; max-width: 620px; }
    .hero-img { display: flex; justify-content: center; }
    .hero-img img { width: 100%; max-width: 520px; border-radius: 24px; box-shadow: 0 40px 120px rgba(124,58,237,.35); opacity: 0; transform: translateY(18px); transition: opacity .8s ease .2s, transform .8s ease .2s; }
    .hero-img img.float { animation: floatY 6s ease-in-out infinite; }
    @keyframes floatY { 0% { transform: translateY(0);} 50% { transform: translateY(-12px);} 100% { transform: translateY(0);} }

    /* Cards & Grids */
    .features-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto; padding: 40px 0; }
    .card, .feature-card { position: relative; background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04)); border: 1px solid rgba(255,255,255,.16); border-radius: var(--radius); padding: 24px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,.35); transition: transform .25s ease, box-shadow .25s ease, background .25s ease; cursor: pointer; }
    .card::before, .feature-card::before { content:""; position: absolute; inset: -2px; border-radius: inherit; background: linear-gradient(135deg, rgba(124,58,237,.6), rgba(6,182,212,.5)); filter: blur(20px); opacity: .25; z-index: -1; }
    .card:hover, .feature-card:hover { transform: perspective(900px) rotateX(3deg) rotateY(-3deg) scale(1.02); box-shadow: 0 30px 90px rgba(124,58,237,.35); }
    .feature-icon { font-size: 42px; margin-bottom: 14px; }
    .feature-title { font-size: 20px; font-weight: 800; letter-spacing: .3px; margin-bottom: 8px; }
    .feature-desc { color: var(--muted); font-size: 15px; }

    /* Thematic sections */
    .about,.mission,.how-works,.partners,.faq,.contact { background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03)); border: 1px solid rgba(255,255,255,.12); border-radius: 28px; box-shadow: 0 24px 80px rgba(0,0,0,.45); }
    .mission-icon { font-size: 64px; background: linear-gradient(135deg, var(--accent-1), var(--accent-2)); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color: transparent; display:inline-block; margin-bottom: 10px; }
    .how-steps { display:flex; flex-wrap: wrap; gap: 18px; justify-content: center; }
    .how-step { flex: 1 1 220px; max-width: 320px; padding: 22px; border-radius: 22px; background: var(--glass); border: 1px solid rgba(255,255,255,.14); transition: transform .25s ease, box-shadow .25s ease; position: relative; }
    .how-step:hover { transform: perspective(900px) rotateX(2deg) rotateY(-4deg) translateY(-4px); box-shadow: 0 20px 60px rgba(6,182,212,.25); }
    .how-step::before { content: attr(data-icon); position: absolute; top: 14px; right: 18px; font-size: 26px; opacity: .35; }

    /* FAQ */
    .faq-list { display: grid; gap: 12px; }
    .faq-item { background: rgba(255,255,255,.05); border: 1px solid rgba(255,255,255,.14); border-radius: 16px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,.35); }
    .faq-item.open { box-shadow: 0 20px 60px rgba(124,58,237,.35), inset 0 0 0 1px rgba(124,58,237,.45); }
    .faq-q { display:flex; justify-content: space-between; align-items:center; padding: 16px 18px; font-family: var(--heading-font); color: var(--accent-2); cursor: pointer; }
    .faq-q .arrow { transition: transform .25s ease; }
    .faq-item.open .arrow { transform: rotate(90deg); }
    .faq-a { max-height: 0; overflow: hidden; padding: 0 18px; color: #d1d5db; transition: max-height .35s ease, padding .35s ease; }
    .faq-item.open .faq-a { max-height: 240px; padding: 0 18px 16px; }

    /* Contact */
    .contact-info p { transition: color .2s ease, transform .2s ease, text-shadow .2s ease; }
    .contact-info p:hover { color: var(--accent-2); transform: translateX(2px) scale(1.01); text-shadow: 0 0 20px rgba(6,182,212,.5); }

    /* Footer */
    .footer { background: rgba(255,255,255,.03); border-top: 1px solid rgba(255,255,255,.14); padding: 48px 24px; }
    .footer-content { max-width: 1200px; margin: 0 auto; display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap: 24px; margin-bottom: 24px; }
    .footer-section h3 { font-weight: 800; margin-bottom: 8px; }
    .footer-section a { color: #cbd5e1; text-decoration: none; }
    .footer-section a:hover { color: var(--accent-2); }
    .footer-bottom { border-top: 1px solid rgba(255,255,255,.12); padding-top: 18px; display:flex; gap:10px; flex-direction: column; align-items:center; }

    /* Reveal on scroll */
    .reveal { opacity: 0; transform: translateY(30px) rotateX(8deg); transform-origin: top; perspective: 900px; transition: opacity .6s ease, transform .6s ease; }
    .reveal.show { opacity: 1; transform: none; }

    /* Modal */
    .modal { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(10,11,16,.6); backdrop-filter: blur(6px); opacity: 0; pointer-events: none; transition: opacity .25s ease; z-index: 1100; }
    .modal.active { opacity: 1; pointer-events: all; }
    .modal-dialog { width: min(92vw, 520px); background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border: 1px solid rgba(255,255,255,.18); border-radius: 18px; box-shadow: 0 20px 80px rgba(0,0,0,.5); padding: 22px; color: #fff; }
    .modal-header { display:flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .modal-title { font-family: var(--heading-font); font-size: 22px; }
    .modal-close { background: transparent; border: none; color: #fff; font-size: 20px; cursor: pointer; }
    .form-group { display:flex; flex-direction: column; gap: 6px; margin-bottom: 12px; }
    .form-group input { padding: 12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,.16); background: rgba(255,255,255,.06); color: #fff; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }

    /* Responsive */
    @media(max-width: 880px) {
      .nav-content { margin: 8px; height: 64px; }
      section { padding: 70px 5%; }
      .hero { grid-template-columns: 1fr; text-align: center; }
      .hero-text { text-align: center; }
    }
  </style>
</head>
<body>
  <div class="bg-blob" aria-hidden="true"></div>
  <!-- Navigation -->
  <nav class="navbar" role="navigation" aria-label="Main">
    <div class="nav-content">
      <div class="logo">
        <div class="logo-icon">AE</div>
        <span class="logo-text">AttendEase</span>
      </div>
      <ul class="nav-links">
        <li><a href="#" id="exploreUsLink" class="btn">Dashboard</a></li>
        <li><a href="#about" class="btn">About</a></li>
        <!-- Analytics updated to open analyt.html -->
        <li><a href="anatyl.html" class="btn">Analytics</a></li>
      </ul>
      <div id="user-auth-area" class="nav-buttons">
        <a href="#signin" class="btn btn-secondary">Sign In</a>
        <a href="#signup" class="btn btn-primary">Sign Up</a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero about">
    <div class="hero-text reveal">
      <h1>AttendEase</h1>
      <p class="hero-subtitle">Master Your Focus, Amplify Your Productivity</p>
      <p class="hero-description">Transform scattered attention into laser-sharp focus with our intelligent productivity platform designed for the modern mind.</p>
      <div class="hero-buttons">
        <button id="startJourneyBtn" class="btn btn-primary btn-lg">Start Your Journey</button>
        <a href="#features" class="btn btn-secondary btn-lg">Our Features</a>
      </div>
    </div>
    <div class="hero-img reveal">
      <img class="float" src="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1880&auto=format&fit=crop" alt="Team collaborating productively" loading="eager" srcset="https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=800 800w, https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1200 1200w, https://images.unsplash.com/photo-1522071820081-009f0129c71c?q=80&w=1600 1600w">
    </div>
  </section>

  <!-- Publisher (visible when signed in) -->
  <section id="adminPublisher" class="about reveal" style="display:none">
    <h2>Publisher</h2>
    <p style="color:#cbd5e1;margin-top:6px">Create announcements and blog posts directly from here (available to any signed-in user).</p>
    <div class="features-container" style="grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:16px;margin-top:12px">
      <div class="card">
        <h3 style="margin-bottom:8px">New Announcement</h3>
        <div class="form-group"><input id="annTitle" placeholder="Title"></div>
        <div class="form-group"><input id="annMessage" placeholder="Message"></div>
        <button id="btnPublishAnn" class="btn btn-primary">Publish Announcement</button>
        <div id="annStatus" style="margin-top:8px;color:#cbd5e1"></div>
      </div>
      <div class="card">
        <h3 style="margin-bottom:8px">New Blog Post</h3>
        <div class="form-group"><input id="blogTitle" placeholder="Title"></div>
        <div class="form-group"><input id="blogExcerpt" placeholder="Excerpt"></div>
        <div class="form-group"><input id="blogImage" placeholder="Image URL (optional)"></div>
        <button id="btnPublishBlog" class="btn btn-primary">Publish Blog</button>
        <div id="blogStatus" style="margin-top:8px;color:#cbd5e1"></div>
      </div>
    </div>
  </section>

  <!-- Feature Section (moved to top) -->
  <section id="features">
    <h2>Our Features</h2>
    <div class="features-container reveal">

      <!-- Online Attendance -->
      <div class="feature-card card" onclick="window.location.href='a.html'">
        <div class="feature-icon">🌐</div>
        <div class="feature-title">Online Attendance</div>
        <div class="feature-desc">
          Mark and manage attendance in real-time with instant updates and tracking.
        </div>
      </div>

      <!-- Offline Attendance -->
      <div class="feature-card card" onclick="window.location.href='main.html'">
        <div class="feature-icon">📴</div>
        <div class="feature-title">Offline Attendance</div>
        <div class="feature-desc">
          Record attendance without internet and sync automatically when you're back online.
        </div>
      </div>

      <!-- Leave Application -->
      <div class="feature-card card" onclick="window.location.href='hm.html'">
        <div class="feature-icon">📊</div>
        <div class="feature-title">Leave Application</div>
        <div class="feature-desc">
          Submit, track, and approve leave requests seamlessly for students, teachers, and admins.
        </div>
      </div>
    </div>
  </section>

  <!-- Mission Section -->
  <section id="mission" class="mission reveal">
    <span class="mission-icon">⭐</span>
    <h2>Our Mission</h2>
    <p style="max-width:900px;margin-top:8px">We help teams transform scattered attention into laser focus through delightful design, real‑time visibility, and humane nudges — so productivity feels effortless.</p>
  </section>

  <!-- How it works -->
  <section id="how" class="how-works reveal">
    <h2>How It Works</h2>
    <div class="how-steps" style="margin-top:16px">
      <div class="how-step card" data-icon="1️⃣"><h3>Capture</h3><p>Mark attendance online or offline, with reliability and speed.</p></div>
      <div class="how-step card" data-icon="2️⃣"><h3>Analyze</h3><p>Visualize engagement, late arrivals, and patterns at a glance.</p></div>
      <div class="how-step card" data-icon="3️⃣"><h3>Act</h3><p>Send reminders, approve leave, and reward consistency — fast.</p></div>
    </div>
  </section>

  <!-- Partners -->
  <section id="partners" class="partners reveal">
    <h2>Trusted By</h2>
    <div class="features-container" style="align-items:center">
      <div class="card"><img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg" alt="Google" style="max-height:32px;filter:grayscale(1);opacity:.9"></div>
      <div class="card"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" alt="Amazon" style="max-height:28px;filter:grayscale(1);opacity:.9"></div>
      <div class="card"><img src="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg" alt="Microsoft" style="max-height:28px;filter:grayscale(1);opacity:.9"></div>
      <div class="card"><img src="https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg" alt="Netflix" style="max-height:24px;filter:grayscale(1);opacity:.9"></div>
    </div>
  </section>

  <!-- Announcements (Firestore) moved below -->
  <section id="announcements" class="reveal">
    <h2>Announcements</h2>
    <div id="announcementsList" class="features-container" style="grid-template-columns: repeat(auto-fit,minmax(320px,1fr));"></div>
  </section>

  <!-- About Section -->
  <section id="about" class="about reveal">
    <h2>About AttentEase</h2>
    <p>Our platform connects teachers, students, parents and administrators in one space, making communication and participation simple and smooth.</p>
  </section>

  <!-- Testimonials -->
  <section id="testimonials" class="reveal">
    <h2>What People Say</h2>
    <div class="testimonial-cards" style="display:flex;gap:16px;flex-wrap:wrap;margin-top:12px">
      <div class="testimonial card" style="flex:1 1 280px;min-width:260px">
        <p>“AttendEase cleaned up our chaotic roll‑calls. Teachers finally have time to teach.”</p>
        <div style="margin-top:10px;color:#cbd5e1">— Priya, Dept. Head</div>
      </div>
      <div class="testimonial card" style="flex:1 1 280px;min-width:260px">
        <p>“Insights on late arrivals helped us change bus timings. Attendance jumped 9%.”</p>
        <div style="margin-top:10px;color:#cbd5e1">— Rahul, Admin</div>
      </div>
      <div class="testimonial card" style="flex:1 1 280px;min-width:260px">
        <p>“As a student, I love the calm UI and reminders. Zero friction.”</p>
        <div style="margin-top:10px;color:#cbd5e1">— Aditi, Student</div>
      </div>
    </div>
  </section>

  <!-- Blog (Firestore) -->
  <section id="blog" class="reveal">
    <h2>Latest from the Blog</h2>
    <div id="blogGrid" class="blog-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:12px"></div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="faq reveal">
    <h2>FAQ</h2>
    <div class="faq-list" style="margin-top:12px">
      <div class="faq-item"><div class="faq-q">Does it work offline? <span class="arrow">▶</span></div><div class="faq-a"><p>Yes — data syncs when you’re back online.</p></div></div>
      <div class="faq-item"><div class="faq-q">Is attendance secure? <span class="arrow">▶</span></div><div class="faq-a"><p>All writes are authenticated with Firebase. You can set granular Firestore rules.</p></div></div>
      <div class="faq-item"><div class="faq-q">Can I export reports? <span class="arrow">▶</span></div><div class="faq-a"><p>Yes, check Analytics for detailed exports.</p></div></div>
    </div>
  </section>

  <!-- Contact Section -->
  <section id="contact" class="contact reveal">
    <h2>Contact Us</h2>
    <p>
      📞 +91 9257404015 <br>
      📞 +91 9717017909 <br>
      📞 +91 8279690362 <br>
      📞 +91 9258935840 <br>
      📞 +91 9053014027 <br>
      📞 +91 9996061229 <br>
      📧 info@sikshasetu.org
    </p>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
      
      </div>
    </div>
    <div class="footer-bottom">
      <p>© 2025 AttentEase. All rights reserved.</p>
    </div>
  </footer>

  <!-- Firebase SDKs (compat) and shared app scripts loaded BEFORE app logic -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="auth.js"></script>

  <!-- Modals -->
  <div id="signinModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="signinTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-header">
        <h3 id="signinTitle" class="modal-title">Sign In</h3>
        <button class="modal-close" aria-label="Close" data-close>×</button>
      </div>
      <div class="modal-body">
        <form id="signinForm">
          <div class="form-group">
            <label for="signinEmail">Email</label>
            <input id="signinEmail" name="email" type="email" autocomplete="email" required>
          </div>
          <div class="form-group">
            <label for="signinPassword">Password</label>
            <input id="signinPassword" name="password" type="password" autocomplete="current-password" minlength="6" required>
          </div>
          <button id="signinBtn" type="submit" class="btn btn-primary" data-default="Sign In">Sign In</button>
          <div style="height:10px"></div>
          <button id="signinGoogle" type="button" class="btn btn-secondary" aria-label="Sign in with Google">Sign in with Google</button>
        </form>
      </div>
    </div>
  </div>

  <div id="signupModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="signupTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-header">
        <h3 id="signupTitle" class="modal-title">Create Account</h3>
        <button class="modal-close" aria-label="Close" data-close>×</button>
      </div>
      <div class="modal-body">
        <form id="signupForm">
          <div class="form-group">
            <label for="signupName">Name</label>
            <input id="signupName" name="name" type="text" autocomplete="name" required>
          </div>
          <div class="form-group">
            <label for="signupEmail">Email</label>
            <input id="signupEmail" name="email" type="email" autocomplete="email" required>
          </div>
          <div class="form-group">
            <label for="signupPassword">Password</label>
            <input id="signupPassword" name="password" type="password" autocomplete="new-password" minlength="6" required>
          </div>
          <button id="signupBtn" type="submit" class="btn btn-primary" data-default="Create Account">Create Account</button>
          <div style="height:10px"></div>
          <button id="signupGoogle" type="button" class="btn btn-secondary" aria-label="Sign up with Google">Continue with Google</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    // Utility: qs
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    // Environment flags
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const isCoarse = window.matchMedia('(pointer: coarse)').matches;

    // Navbar: shrink on scroll
    const navbar = $('.navbar');
    let lastY = window.scrollY;
    let rafId = 0;
    const onScroll = () => {
      const y = window.scrollY;
      if (y > 20) navbar.classList.add('shrink'); else navbar.classList.remove('shrink');
      lastY = y;
      if (!prefersReduced) {
        if (rafId) cancelAnimationFrame(rafId);
        rafId = requestAnimationFrame(parallax3D);
      }
    };
    window.addEventListener('scroll', onScroll, { passive: true });

    // Smooth scroll / modal triggers from navbar
    $$('#user-auth-area a[href^="#"]').forEach(a => {
      a.addEventListener('click', (e) => {
        const hash = a.getAttribute('href');
        if (hash === '#signin') { e.preventDefault(); openModal('signinModal'); }
        if (hash === '#signup') { e.preventDefault(); openModal('signupModal'); }
      });
    });

    // Maintain existing Dashboard redirect
    $('#exploreUsLink')?.addEventListener('click', function(e) {
      e.preventDefault();
      window.location.href = 'login.html';
    });

    // Start Journey scroll
    $('#startJourneyBtn')?.addEventListener('click', () => {
      $('#features')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });

    // Reveal on scroll
    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('show');
      });
    }, { threshold: 0.18 });
    $$('.reveal').forEach(el => revealObserver.observe(el));

    // Section entrance
    const sectionObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('section-visible');
      });
    }, { threshold: 0.15 });
    $$('section, .about, .mission, .how-works, .partners, .faq, .contact').forEach(el => sectionObserver.observe(el));

    // 3D tilt on cards
    function applyTilt() {
      if (isCoarse || prefersReduced) return; // skip on touch devices or reduced motion
      $$('.card').forEach(card => {
        let rect;
        const onMove = (e) => {
          rect = rect || card.getBoundingClientRect();
          const px = (e.clientX - rect.left) / rect.width - 0.5;
          const py = (e.clientY - rect.top) / rect.height - 0.5;
          card.style.transform = `perspective(900px) rotateX(${(-py*8).toFixed(2)}deg) rotateY(${(px*8).toFixed(2)}deg) scale(1.02)`;
        };
        const reset = () => { card.style.transform = ''; rect = undefined; };
        card.addEventListener('mousemove', onMove);
        card.addEventListener('mouseleave', reset);
      });
    }
    applyTilt();

    // Parallax/3D on scroll
    function parallax3D() {
      if (prefersReduced) return;
      const heroImg = $('.hero-img img');
      if (heroImg) {
        const y = Math.min(1, window.scrollY / 400);
        const factor = isCoarse ? 0.5 : 1;
        heroImg.style.transform = `translateY(${y* -20*factor}px) rotateY(${y*6*factor}deg) scale(${1 + y*0.02*factor})`;
      }
      const cards = $$('#features .card');
      const rect = $('#features')?.getBoundingClientRect();
      if (rect) {
        const visibility = Math.max(0, 1 - Math.abs(rect.top - window.innerHeight/2) / (window.innerHeight));
        if (!isCoarse) {
          cards.forEach((c, i) => {
            const ry = (i % 2 === 0 ? 1 : -1) * visibility * 6;
            c.style.transform = `perspective(900px) rotateY(${ry}deg) rotateX(${visibility*2}deg) scale(${1 + visibility*0.01})`;
          });
        }
      }
    }
    window.addEventListener('resize', () => { if (!prefersReduced) parallax3D(); });
    setTimeout(() => { if (!prefersReduced) parallax3D(); const hi = $('.hero-img img'); if (hi?.style) { hi.style.opacity = '1'; if (prefersReduced) hi.style.transform = ''; } }, 300);

    // Image load polish: ensure images become visible
    window.addEventListener('load', () => {
      $$('img').forEach(img => { if (img.getAttribute('loading') !== 'eager') img.loading = 'lazy'; img.style.opacity = '1'; });
    });

    // FAQ accordion (if present in future)
    $$('.faq-item .faq-q').forEach(q => {
      q.addEventListener('click', () => {
        const item = q.closest('.faq-item');
        $$('.faq-item').forEach(i => i !== item && i.classList.remove('open'));
        item?.classList.toggle('open');
      });
    });

    // Modal system with accessibility & focus trapping
    let activeModal = null; let lastFocused = null;
    function trapFocus(modal) {
      const focusables = $$('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])', modal).filter(el => !el.hasAttribute('disabled'));
      const first = focusables[0]; const last = focusables[focusables.length - 1];
      modal.addEventListener('keydown', (e) => {
        if (e.key === 'Tab') {
          if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
          else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
        }
        if (e.key === 'Escape') { closeModal(modal.id); }
      });
      first?.focus();
    }
    function openModal(id) {
      const modal = document.getElementById(id);
      if (!modal) return;
      lastFocused = document.activeElement;
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
      activeModal = modal; trapFocus(modal);
    }
    function closeModal(id) {
      const modal = document.getElementById(id) || activeModal;
      if (!modal) return;
      modal.classList.remove('active');
      document.body.style.overflow = '';
      activeModal = null; lastFocused?.focus();
    }
    $$('[data-close]').forEach(btn => btn.addEventListener('click', () => closeModal(btn.closest('.modal')?.id)));
    document.addEventListener('click', (e) => { if (activeModal && e.target === activeModal) closeModal(activeModal.id); });

    // Smooth scroll for navbar links that start with # but are not auth
    $$('nav .nav-links a[href^="#"]').forEach(link => {
      link.addEventListener('click', (e) => {
        const id = link.getAttribute('href');
        if (id && id !== '#signin' && id !== '#signup') {
          const el = document.querySelector(id);
          if (el) { e.preventDefault(); el.scrollIntoView({ behavior: 'smooth' }); }
        }
      });
    });

    // Toast alerts
    function showAlert(msg, type='info') {
      const el = document.createElement('div');
      el.textContent = msg;
      el.style.cssText = 'position:fixed;top:90px;right:20px;padding:10px 14px;border-radius:12px;font-weight:700;z-index:1200;box-shadow:0 10px 30px rgba(0,0,0,.45);';
      el.style.background = type === 'error' ? 'linear-gradient(135deg,#ef4444,#f59e0b)' : 'linear-gradient(135deg,#06b6d4,#7c3aed)';
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 2200);
    }

    // Firebase globals are provided by firebase-config.js; always reference via window

    // Sign Up
    $('#signupForm')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const btn = $('#signupBtn'); const def = btn.dataset.default;
      btn.disabled = true; btn.textContent = 'Creating...';
      const name = $('#signupName').value.trim();
      const email = $('#signupEmail').value.trim();
      const pass = $('#signupPassword').value;
      try {
        if (!window.auth) throw new Error('Auth unavailable');
        const cred = await window.auth.createUserWithEmailAndPassword(email, pass);
        await cred.user.updateProfile({ displayName: name });
        showAlert('Welcome aboard!'); closeModal('signupModal');
      } catch (err) { console.error(err); showAlert(err.message || 'Sign up failed', 'error'); }
      finally { btn.disabled = false; btn.textContent = def; }
    });

    // Sign In
    $('#signinForm')?.addEventListener('submit', async (e) => {
      e.preventDefault();
      const btn = $('#signinBtn'); const def = btn.dataset.default;
      btn.disabled = true; btn.textContent = 'Signing in...';
      const email = $('#signinEmail').value.trim();
      const pass = $('#signinPassword').value;
      try {
        if (!window.auth) throw new Error('Auth unavailable');
        await window.auth.signInWithEmailAndPassword(email, pass);
        showAlert('Signed in!'); closeModal('signinModal');
      } catch (err) { console.error(err); showAlert(err.message || 'Sign in failed', 'error'); }
      finally { btn.disabled = false; btn.textContent = def; }
    });

    // Google auth buttons
    async function handleGoogle() {
      try {
        if (!window.signInWithGoogle) throw new Error('Google auth unavailable');
        await window.signInWithGoogle();
        showAlert('Welcome!');
        closeModal('signinModal'); closeModal('signupModal');
      } catch (e) { showAlert(e.message || 'Google sign-in failed', 'error'); }
    }
    $('#signinGoogle')?.addEventListener('click', handleGoogle);
    $('#signupGoogle')?.addEventListener('click', handleGoogle);

    // Auth state UI
    function setAuthUI(user) {
      const area = $('#user-auth-area');
      if (!area) return;
      if (user) {
        const name = user.displayName || user.email;
        const avatar = `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=7c3aed&color=fff&rounded=true&size=64`;
        area.innerHTML = `
          <div class="user-menu">
            <img src="${avatar}" alt="${name}" style="width:32px;height:32px;border-radius:50%;border:1px solid rgba(255,255,255,.25);vertical-align:middle;"> 
            <span style="margin-left:8px;vertical-align:middle;">${name}</span>
            <button id="logoutBtn" class="btn" style="margin-left:10px;">Log Out</button>
          </div>`;
        $('#logoutBtn')?.addEventListener('click', async () => { try { await window.signOutUser(); } catch(e){ showAlert('Error logging out','error'); } });
      } else {
        area.innerHTML = `
          <a href="#signin" class="btn btn-secondary">Sign In</a>
          <a href="#signup" class="btn btn-primary">Sign Up</a>`;
        $$('#user-auth-area a[href^="#"]').forEach(a => {
          a.addEventListener('click', (e) => {
            const hash = a.getAttribute('href');
            if (hash === '#signin') { e.preventDefault(); openModal('signinModal'); }
            if (hash === '#signup') { e.preventDefault(); openModal('signupModal'); }
          });
        });
      }
    }
    // Attach auth state once Firebase has loaded and toggle admin tools
    let CURRENT_USER = null;
    let CURRENT_ROLE = 'student';
    async function onAuthChanged(user){
      setAuthUI(user);
      CURRENT_USER = user || null;
      try{
        const panel = document.getElementById('adminPublisher');
        if(panel) panel.style.display = user ? 'block' : 'none';
        // fetch role for permissions
        if (user && window.db){
          const snap = await db.collection('users').doc(user.uid).get();
          CURRENT_ROLE = snap.exists ? (snap.data().role || 'student') : 'student';
        } else {
          CURRENT_ROLE = 'student';
        }
      }catch(_){ /* silent */ }
    }
    if (window.auth) { window.auth.onAuthStateChanged(onAuthChanged); } else { setAuthUI(null); }
    window.addEventListener('load', () => { if (window.auth) window.auth.onAuthStateChanged(onAuthChanged); });

    // Firestore-powered content (public reads): realtime listeners
    function startAnnouncementsListener(){
      if(!window.db) return;
      const wrap = document.getElementById('announcementsList'); if(!wrap) return;
      return db.collection('public_announcements').orderBy('createdAt','desc').limit(12)
        .onSnapshot((snap)=>{
          wrap.innerHTML = '';
          if (snap.empty) { wrap.innerHTML = '<div class="card">No announcements yet.</div>'; return; }
          snap.forEach(doc=>{
            const d = doc.data();
            const by = d.authorName || d.authorEmail || '';
            const el = document.createElement('div'); el.className='card';
            el.innerHTML = `<h3 style="margin-bottom:6px">${d.title||'Untitled'}</h3>
                            <p class="feature-desc">${d.message||''}</p>
                            <div class="small" style="opacity:.8;margin-top:6px">${by?('By '+by):''}</div>`;
            wrap.appendChild(el);
          });
        }, ()=>{ /* silent */ });
    }

    function canManagePost(data){
      if (!CURRENT_USER) return false;
      if (data && data.authorUid && data.authorUid === CURRENT_USER.uid) return true;
      return CURRENT_ROLE === 'admin';
    }

    function startBlogListener(){
      if(!window.db) return;
      const grid = document.getElementById('blogGrid'); if(!grid) return;
      return db.collection('blog_posts').orderBy('createdAt','desc').limit(12)
        .onSnapshot((snap)=>{
          grid.innerHTML = '';
          if (snap.empty) { grid.innerHTML = '<div class="card">No posts yet.</div>'; return; }
          snap.forEach(doc=>{
            const d = doc.data();
            const img = d.image || 'https://images.unsplash.com/photo-1556157382-97eda2d62296?q=80&w=1200&auto=format&fit=crop';
            const by = d.authorName || d.authorEmail || '';
            const el = document.createElement('div'); el.className='blog-card card';
            const manage = canManagePost(d);
            el.setAttribute('data-post-id', doc.id);
            el.innerHTML = `
              <div style="overflow:hidden;border-radius:16px;margin:-6px -6px 10px -6px">
                <img src="${img}" alt="${d.title||'Post'}" style="width:100%;display:block;opacity:.95">
              </div>
              <h3 style="margin-bottom:6px">${d.title||'New Post'}</h3>
              <p class="feature-desc">${(d.excerpt||'').toString().slice(0,140)}${(d.excerpt||'').length>140?'…':''}</p>
              <div class="small" style="opacity:.8;margin-top:6px">${by?('By '+by):''}</div>
              <div class="post-actions" style="display:flex;gap:8px;align-items:center;margin-top:10px">
                <button class="btn btn-secondary btn-like" style="padding:8px 12px">❤️ Like <span class="like-count">0</span></button>
                ${manage ? '<button class="btn btn-secondary btn-edit" style="padding:8px 12px">Edit</button>' : ''}
                ${manage ? '<button class="btn btn-secondary btn-delete" style="padding:8px 12px">Delete</button>' : ''}
              </div>
              <div class="comments" style="margin-top:10px">
                <div class="small" style="opacity:.9;margin-bottom:6px">Comments</div>
                <div class="comment-list" style="display:flex;flex-direction:column;gap:8px"></div>
                <div class="comment-form" style="display:flex;gap:8px;margin-top:8px">
                  <input class="comment-input" placeholder="Write a comment..." style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.04);color:#fff">
                  <button class="btn btn-primary btn-comment">Post</button>
                </div>
              </div>
            `;
            grid.appendChild(el);
            setupBlogCardInteractions(el, doc.id, d);
          });
        }, ()=>{ /* silent */ });
    }

    function setupBlogCardInteractions(cardEl, postId, data){
      // Likes count listener and toggle
      const likeBtn = cardEl.querySelector('.btn-like');
      const likeCountEl = cardEl.querySelector('.like-count');
      let liked = false; let likeUnsub = null; let myLikeUnsub = null;

      if (window.db){
        likeUnsub = db.collection('blog_posts').doc(postId).collection('likes')
          .onSnapshot(snap=>{ likeCountEl.textContent = String(snap.size || 0); });
        if (CURRENT_USER){
          myLikeUnsub = db.collection('blog_posts').doc(postId).collection('likes').doc(CURRENT_USER.uid)
            .onSnapshot(s=>{ liked = s.exists; likeBtn.textContent = (liked? '💔 Unlike ' : '❤️ Like ') + likeCountEl.textContent; });
        }
      }
      likeBtn?.addEventListener('click', async ()=>{
        if (!CURRENT_USER) return showAlert('Sign in to like','error');
        try{
          const ref = db.collection('blog_posts').doc(postId).collection('likes').doc(CURRENT_USER.uid);
          if (liked) { await ref.delete(); } else { await ref.set({ uid: CURRENT_USER.uid, at: firebase.firestore.FieldValue.serverTimestamp() }); }
        }catch(e){ /* silent */ }
      });

      // Comments listener and add
      const list = cardEl.querySelector('.comment-list');
      const input = cardEl.querySelector('.comment-input');
      const postBtn = cardEl.querySelector('.btn-comment');
      let commentsUnsub = null;
      if (window.db){
        commentsUnsub = db.collection('blog_posts').doc(postId).collection('comments')
          .orderBy('createdAt','desc').limit(10)
          .onSnapshot(snap=>{
            list.innerHTML='';
            if (snap.empty){ list.innerHTML = '<div class="small" style="opacity:.7">No comments yet.</div>'; return; }
            snap.forEach(doc=>{
              const c = doc.data();
              const item = document.createElement('div');
              item.className = 'card';
              item.style.padding = '10px';
              item.innerHTML = `<div style="font-weight:600">${c.authorName || c.authorEmail || 'User'}</div><div class="small">${c.text||''}</div>`;
              list.appendChild(item);
            });
          });
      }
      postBtn?.addEventListener('click', async ()=>{
        if (!CURRENT_USER) return showAlert('Sign in to comment','error');
        const text = (input.value || '').trim();
        if (!text) return;
        try{
          await db.collection('blog_posts').doc(postId).collection('comments').add({
            text,
            authorUid: CURRENT_USER.uid,
            authorName: CURRENT_USER.displayName || null,
            authorEmail: CURRENT_USER.email || null,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
          });
          input.value = '';
        }catch(e){ /* silent */ }
      });

      // Edit/Delete if allowed
      const editBtn = cardEl.querySelector('.btn-edit');
      const deleteBtn = cardEl.querySelector('.btn-delete');
      editBtn?.addEventListener('click', async ()=>{
        if (!canManagePost(data)) return showAlert('Not allowed','error');
        const newTitle = prompt('Edit title', data.title || '');
        if (newTitle === null) return;
        const newExcerpt = prompt('Edit excerpt', data.excerpt || '');
        if (newExcerpt === null) return;
        const newImage = prompt('Edit image URL (optional)', data.image || '');
        try{
          await db.collection('blog_posts').doc(postId).set({
            title: newTitle.trim() || data.title || 'Untitled',
            excerpt: newExcerpt.trim() || data.excerpt || '',
            image: (newImage||'').trim() || null,
          }, { merge:true });
          showAlert('Updated');
        }catch(e){ showAlert('Update failed','error'); }
      });
      deleteBtn?.addEventListener('click', async ()=>{
        if (!canManagePost(data)) return showAlert('Not allowed','error');
        if (!confirm('Delete this post?')) return;
        try{ await db.collection('blog_posts').doc(postId).delete(); showAlert('Deleted'); }
        catch(e){ showAlert('Delete failed','error'); }
      });

      // Cleanup on card removal
      cardEl.addEventListener('DOMNodeRemoved', ()=>{
        try{ likeUnsub && likeUnsub(); }catch(_){}
        try{ myLikeUnsub && myLikeUnsub(); }catch(_){}
        try{ commentsUnsub && commentsUnsub(); }catch(_){}
      });
    }

    let unsubs=[];
    window.addEventListener('load', ()=>{
      const a = startAnnouncementsListener(); if (typeof a === 'function') unsubs.push(a);
      const b = startBlogListener(); if (typeof b === 'function') unsubs.push(b);
      window.addEventListener('beforeunload', ()=>{ unsubs.forEach(u=>{ try{u();}catch(_){} }); });
    });

    // Admin publishing handlers
    document.getElementById('btnPublishAnn')?.addEventListener('click', async () => {
      try{
        const t = document.getElementById('annTitle').value.trim();
        const m = document.getElementById('annMessage').value.trim();
        if(!t||!m) return showAlert('Fill title and message','error');
        const u = (window.auth && window.auth.currentUser) ? window.auth.currentUser : null;
        await db.collection('public_announcements').add({
          title:t,
          message:m,
          createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          authorUid: u?.uid || null,
          authorName: u?.displayName || null,
          authorEmail: u?.email || null
        });
        document.getElementById('annStatus').textContent = 'Published ✅';
      }catch(e){ showAlert(e.message||'Failed to publish announcement','error'); }
    });

    document.getElementById('btnPublishBlog')?.addEventListener('click', async () => {
      try{
        const t = document.getElementById('blogTitle').value.trim();
        const x = document.getElementById('blogExcerpt').value.trim();
        const i = document.getElementById('blogImage').value.trim();
        if(!t||!x) return showAlert('Fill title and excerpt','error');
        const u = (window.auth && window.auth.currentUser) ? window.auth.currentUser : null;
        await db.collection('blog_posts').add({
          title:t,
          excerpt:x,
          image:i||null,
          createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          authorUid: u?.uid || null,
          authorName: u?.displayName || null,
          authorEmail: u?.email || null
        });
        document.getElementById('blogStatus').textContent = 'Published ✅';
      }catch(e){ showAlert(e.message||'Failed to publish blog','error'); }
    });
  </script>
</body>
</html>
